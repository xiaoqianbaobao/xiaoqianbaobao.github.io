<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>基于树莓派 Piwigo的家庭云相册 | Qian&#39;s Blog</title>
<meta name="keywords" content="树莓派">
<meta name="description" content="基于树莓派-piwigo/apache2 的家庭云相册搭建 背景 近期由于拍摄了很多我和胡小蕊在一起的照片，包括生活照片和出去游玩的照片，所以想搞">
<meta name="author" content="
作者:&nbsp;ShengQian">
<link rel="canonical" href="https://csqread.top/posts/tech/%E5%9F%BA%E4%BA%8E%E6%A0%91%E8%8E%93%E6%B4%BE-piwigo%E7%9A%84%E5%AE%B6%E5%BA%AD%E4%BA%91%E7%9B%B8%E5%86%8C/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1304ba2a97d1ed976f43dcc4aec65464735b44589d091030cdd2873f2234b886.css" integrity="" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js" integrity=""
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://csqread.top/img/Q.gif">
<link rel="icon" type="image/png" sizes="16x16" href="https://csqread.top/img/%21.jpg">
<link rel="icon" type="image/png" sizes="32x32" href="https://csqread.top/img/%21.jpg">
<link rel="apple-touch-icon" href="https://csqread.top/%21.jpg">
<link rel="mask-icon" href="https://csqread.top/%21.jpg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="基于树莓派 Piwigo的家庭云相册" />
<meta property="og:description" content="基于树莓派-piwigo/apache2 的家庭云相册搭建 背景 近期由于拍摄了很多我和胡小蕊在一起的照片，包括生活照片和出去游玩的照片，所以想搞" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://csqread.top/posts/tech/%E5%9F%BA%E4%BA%8E%E6%A0%91%E8%8E%93%E6%B4%BE-piwigo%E7%9A%84%E5%AE%B6%E5%BA%AD%E4%BA%91%E7%9B%B8%E5%86%8C/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-02-18T21:46:29+08:00" />
<meta property="article:modified_time" content="2024-02-18T21:46:29+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="基于树莓派 Piwigo的家庭云相册"/>
<meta name="twitter:description" content="基于树莓派-piwigo/apache2 的家庭云相册搭建 背景 近期由于拍摄了很多我和胡小蕊在一起的照片，包括生活照片和出去游玩的照片，所以想搞"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://csqread.top/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "技术",
      "item": "https://csqread.top/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "基于树莓派 Piwigo的家庭云相册",
      "item": "https://csqread.top/posts/tech/%E5%9F%BA%E4%BA%8E%E6%A0%91%E8%8E%93%E6%B4%BE-piwigo%E7%9A%84%E5%AE%B6%E5%BA%AD%E4%BA%91%E7%9B%B8%E5%86%8C/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "基于树莓派 Piwigo的家庭云相册",
  "name": "基于树莓派 Piwigo的家庭云相册",
  "description": "基于树莓派-piwigo/apache2 的家庭云相册搭建 背景 近期由于拍摄了很多我和胡小蕊在一起的照片，包括生活照片和出去游玩的照片，所以想搞",
  "keywords": [
    "树莓派"
  ],
  "articleBody": "基于树莓派-piwigo/apache2 的家庭云相册搭建 背景 近期由于拍摄了很多我和胡小蕊在一起的照片，包括生活照片和出去游玩的照片，所以想搞一个家庭云相册，可以用于实时同步手机中的照片到云相册上。因为考虑到公有云相册的隐私安全保障问题，以及我想自己DIY一些功能。还有就是自己的手机内存问题以及手机自带的云相册需要付费申请更大的空间，我不想付费。因此我想可以利用树莓派作为服务器，寻找一个开源的云相册管理系统自己部署到服务器上，最好是带有软件的开源云相册。找来找去发现了这款PiWigo云相册，详细请见： PIWIGO 官网，这里是github地址: PIWIGO github仓库 1、介绍 这篇博客介绍如何在树莓派4上安装PiWigo作为一个web server。 Piwigo是一个开源的相册管理软件，可以轻松的管理我们的照片和相册。我们可以在PC端或者安卓端以及iphone上进行浏览和同步。\n2、要求 下面这些是必须需要提前准备好的：\n树莓派4B 以及安装好Raspberry Pi OS 这个不在本教程之内 树莓派4B的终端，这个一般安装好树莓派OS就会有，但是最好打开SSH连接，远程操作，一般树莓派也就是当作一个服务器 3、配置树莓派4B作为一个WEB 服务器 3.1 确认 Raspberry Pi 4 OS 是最新的 在执行该命令之前，若是中国大陆用户需要将apt源更换，具体更换流程： 如何更换树莓派OS软件源\n1 sudo apt update -y \u0026\u0026 sudo apt upgrade -y \u0026\u0026 sudo apt autoremove -y 3.2 安装WEB服务 (Apache) 我们知道web服务有很多选择，例如nginx apache,我们这里选择Apache\n1 sudo apt install apache2 -y 等待终端打印字符结束，可以打开本地树莓派ip地址，看到以下网页显示即安装成功 3.3 安装PHP相关依赖 1 sudo apt install php-imagick php-gd ffmpeg php-mbstring php-xml -y 3.4 安装数据库 我们使用MariaDB 代替Mysql, MariaDB是Mysql的一个子分支，但是更小更轻便\n1、输入以下代码安装mariadb\n1 sudo apt install mariadb-server php-mysql -y 2、等待安装完成之后，输入以下命令配置数据库相关信息及环境变量\n1 sudo mysql_secure_installation 执完命令之后，终端将会显示如下 3、依次回答终端上显示的问题如下:\nAs no password has been set yet press enter. Switch to unix_socket authentication [Y/n] –\u003e n Change the root password? [Y/n] –\u003e Y New password: –\u003e type your new root password Make sure you remember/store is for example with the Keepass password manager. Re-enter new password: –\u003e type again your new root password Remove anonymous users? [Y/n] –\u003e Y Info displayed in Terminal window: By default, a MariaDB installation has an anonymous user, allowing anyone to log into MariaDB without having to have a user account created for them. This is intended only for testing, and to make the installation go a bit smoother. You should remove them before moving into a production environment. Disallow root login remotely? [Y/n] –\u003e Y Info displayed in Terminal window: Normally, root should only be allowed to connect from ‘localhost’. This ensures that someone cannot guess at the root password from the network. Remove test database and access to it? [Y/n] –\u003e Y Info displayed in Terminal window: By default, MariaDB comes with a database named ‘test’ that anyone can access. This is also intended only for testing, and should be removed before moving into a production environment. Reload privilege tables now? [Y/n] –\u003e Y Info displayed in Terminal window: Reloading the privilege tables will ensure that all changes made so far will take effect immediately. 4、为了更好的管理我们的数据库我们安装一个phpMyAdmin\n1 sudo apt install phpmyadmin -y 5、在终端显示的设置中，我们进行以下设置： a、使用空格键选择apache2（选择到后会显示一个*号），然后我们使用TAB键选择OK，ENTER,继续下一步: b、选择yes to configure the database for phpmyadmin with dbconfig-common.\nc、下一个终端显示的配置中，配置我们数据库用户phpmyadmin的密码 6、给予 phpMyAdmin 用户权限 a、使用root用户登录 MariaDB\n1 sudo mysql -uroot -p 给予权限\n1 2 3 grant all privileges on *.* to 'phpmyadmin'@'localhost'; flush privileges; quit 7、重启树莓派\n1 sudo reboot 8、打开树莓派对应局域网ip:for example http://192.168.2.148/phpmyadmin, 可以见到以下页面 9、使用 phpmyadmin作为用户名，密码为刚刚设置的密码进行登录\n4、安装Piwigo 在安装PiWiGo之前，数据库需要初始化，新建库表等操作\n4.1 设置数据库 1、以root用户名登录数据库\n1 sudo mariadb -u root 2、创建数据库 piwigo_13_dev, 你可以用你喜欢的名称\n1 create database piwigo_13_dev; 3、将 Piwigo 数据库的所有权限授予您将在后续步骤中在 Piwigo 中配置的用户（带密码）\n1 2 grant all privileges on piwigo_13_dev.* to piwigo_13_dev_user@localhost identified by '********'; 4、刷新权限表以使更改生效，然后退出\n1 2 flush privileges; exit; 4.2 安装Piwigo 我们使用手动方法来安装Piwigo。\n1、直接在树莓派中下载安装包并解压\n1 2 curl http://piwigo.org/download/dlcounter.php?code=latest -o piwigo.zip unzip piwigo.zip 2、现在必须将包含解压缩的 Piwigo 文件的文件夹的内容移至 Apache 公共文件夹中。将“PIWIGO”文件夹替换为您喜欢的名称（小写），记住在 URL 和以下命令中都使用您的文件夹名称：\n1 2 sudo mkdir /var/www/html/PIWIGO sudo mv piwigo/{.,}* /var/www/html/PIWIGO/ 就我而言，我使用了\n1 2 sudo mkdir /var/www/html/piwigo13dev sudo mv piwigo/{.,}* /var/www/html/piwigo13dev/ move命令mv会给出警告，；设备或资源繁忙，无法移动…等, 可以忽略，我们可以直接到目标文件夹中查看，发现已经全部移动过去了\n3、为公共文件夹分配正确的权限，以便 Piwigo 安装程序能够执行其任务：\n1 sudo chown -R www-data:www-data /var/www/html/ 4、删除用于解压 piwigo 文件的文件夹\n1 rmdir piwigo/ 5、我们现在使用浏览器来完成安装步骤。输入您的 Raspberry PI 的 IP 地址作为 URL，后跟步骤 2 中使用的“piwigo”文件夹名称。所以在我的例子中，它变成 http://192.168.2.148/piwigo13dev 将显示 Piwigo 安装页面。 6、添加您的数据库名称、数据库用户和数据库用户密码。将主机变量设置为“localhost”。\n7、选择 piwigo 管理员用户名、密码和电子邮件地址。这些将是您用来访问网络仪表板的。就我而言，我输入了以下内容：\n8、单击“开始安装”。\n5、安装成功后的一些设置 通过照片管理可以进行添加照片等操作，相册管理可以进行相册的增加与删除修改。可以下载相应的APP与该服务端进行交互，设置同步相册可以进行定时同步操作.\n在实际使用中我也遇到了一些问题，比如在ios端设置自动同步相册的时候，不能选择多久同步一次，但是在安卓端就有这个功能，然后在IOS端和安卓端都不能设置多个相册同步，只能选择单个相册同步，在这个项目的issue里好像也没有看到有人吐槽过这个问题，不过这些问题都不属于bug，吐槽了作者估计也不会搭理，后续看看有时间自己fork过来改进一下…\n自动上传这块可设置的东西太少了！ 6、参考文章: 1、 How to install Piwigo on a Raspberry Pi 4? 2、 How to Install and Use Piwigo on Your Raspberry Pi 3、Piwigo and Raspberry PI: a Private Open Source Photo Management Platform\n",
  "wordCount" : "2318",
  "inLanguage": "zh",
  "datePublished": "2024-02-18T21:46:29+08:00",
  "dateModified": "2024-02-18T21:46:29+08:00",
  "author":[{
    "@type": "Person",
    "name": "ShengQian"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://csqread.top/posts/tech/%E5%9F%BA%E4%BA%8E%E6%A0%91%E8%8E%93%E6%B4%BE-piwigo%E7%9A%84%E5%AE%B6%E5%BA%AD%E4%BA%91%E7%9B%B8%E5%86%8C/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Qian's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://csqread.top/img/Q.gif"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://csqread.top" accesskey="h" title="Qian&#39;s Blog (Alt + H)">
                <img src="https://csqread.top/img/%21.jpg" alt="" aria-label="logo"
                    height="35">Qian&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://csqread.top/search" title="🔍搜索">
                    <span>🔍搜索</span>
                </a>
            </li>
            <li>
                <a href="https://csqread.top/" title="🏠主页">
                    <span>🏠主页</span>
                </a>
            </li>
            <li>
                <a href="https://csqread.top/posts" title="📚文章">
                    <span>📚文章</span>
                </a>
            </li>
            <li>
                <a href="https://csqread.top/archives/" title="⏱时间轴">
                    <span>⏱时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://csqread.top/tags" title="🔖标签">
                    <span>🔖标签</span>
                </a>
            </li>
            <li>
                <a href="https://csqread.top/about" title="🙋🏻‍♂️关于">
                    <span>🙋🏻‍♂️关于</span>
                </a>
            </li>
            <li>
                <a href="https://csqread.top/links" title="🤝友链">
                    <span>🤝友链</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://csqread.top">主页</a>&nbsp;»&nbsp;<a href="https://csqread.top/posts/">Posts</a>&nbsp;»&nbsp;<a href="https://csqread.top/posts/tech/">技术</a></div>
    <h1 class="post-title">
      基于树莓派 Piwigo的家庭云相册
    </h1>
    <div class="post-meta">










创建:&nbsp;<span title='2024-02-18 21:46:29 +0800 CST'>2024-02-18</span>&nbsp;|&nbsp;更新:&nbsp;2024-02-18&nbsp;|&nbsp;字数:&nbsp;2318字&nbsp;|&nbsp;时长: 5分钟&nbsp;|&nbsp;
作者:&nbsp;ShengQian


    &nbsp;|&nbsp;标签: &nbsp;
    <ul class="post-tags-meta">
        <a href="https://csqread.top/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/">树莓派</a>
    </ul>

    
    
    
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_page_pv">
        &nbsp;| 访问: <span id="busuanzi_value_page_pv"></span>
    </span>

    
    
    
    
    <script src="https://cdn.staticfile.org/twikoo/1.4.11/twikoo.all.min.js">
    </script>
    <script>
        let url = document.documentURI
        
        let dnsUrl = "https://csqread.top"
        let urlSplit = url.split(dnsUrl)
        let finalUrl = urlSplit[1]
        if (finalUrl[0] !== '/') {
            finalUrl = '/'+finalUrl
        }
        twikoo.getCommentsCount({
            envId:  null ,
            region:  null ,
            urls: [
                finalUrl,
            ],
            includeReply: false 
        }).then(function (res) {
            let count = res[0].count
            const obj = document.getElementById("comment_count");
            obj.innerText = count
            
            
            
        }).catch(function (err) {
            
            console.error(err);
        });
    </script>
    &nbsp;| 评论: &nbsp; <span id="comment_count"></span>

</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">目录</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e5%9f%ba%e4%ba%8e%e6%a0%91%e8%8e%93%e6%b4%be-piwigoapache2-%e7%9a%84%e5%ae%b6%e5%ba%ad%e4%ba%91%e7%9b%b8%e5%86%8c%e6%90%ad%e5%bb%ba" aria-label="基于树莓派-piwigo/apache2 的家庭云相册搭建">基于树莓派-piwigo/apache2 的家庭云相册搭建</a><ul>
                            
                    <li>
                        <a href="#%e8%83%8c%e6%99%af" aria-label="背景">背景</a><ul>
                            
                    <li>
                        <a href="#1%e4%bb%8b%e7%bb%8d" aria-label="1、介绍">1、介绍</a></li>
                    <li>
                        <a href="#2%e8%a6%81%e6%b1%82" aria-label="2、要求">2、要求</a></li>
                    <li>
                        <a href="#3%e9%85%8d%e7%bd%ae%e6%a0%91%e8%8e%93%e6%b4%be4b%e4%bd%9c%e4%b8%ba%e4%b8%80%e4%b8%aaweb-%e6%9c%8d%e5%8a%a1%e5%99%a8" aria-label="3、配置树莓派4B作为一个WEB 服务器">3、配置树莓派4B作为一个WEB 服务器</a><ul>
                            
                    <li>
                        <a href="#31-%e7%a1%ae%e8%ae%a4-raspberry-pi-4-os-%e6%98%af%e6%9c%80%e6%96%b0%e7%9a%84" aria-label="3.1 确认 Raspberry Pi 4 OS 是最新的">3.1 确认 Raspberry Pi 4 OS 是最新的</a></li>
                    <li>
                        <a href="#32-%e5%ae%89%e8%a3%85web%e6%9c%8d%e5%8a%a1--apache" aria-label="3.2 安装WEB服务  (Apache)">3.2 安装WEB服务  (Apache)</a></li>
                    <li>
                        <a href="#33-%e5%ae%89%e8%a3%85php%e7%9b%b8%e5%85%b3%e4%be%9d%e8%b5%96" aria-label="3.3 安装PHP相关依赖">3.3 安装PHP相关依赖</a></li>
                    <li>
                        <a href="#34-%e5%ae%89%e8%a3%85%e6%95%b0%e6%8d%ae%e5%ba%93" aria-label="3.4 安装数据库">3.4 安装数据库</a></li></ul>
                    </li>
                    <li>
                        <a href="#4%e5%ae%89%e8%a3%85piwigo" aria-label="4、安装Piwigo">4、安装Piwigo</a><ul>
                            
                    <li>
                        <a href="#41-%e8%ae%be%e7%bd%ae%e6%95%b0%e6%8d%ae%e5%ba%93" aria-label="4.1 设置数据库">4.1 设置数据库</a></li>
                    <li>
                        <a href="#42-%e5%ae%89%e8%a3%85piwigo" aria-label="4.2 安装Piwigo">4.2 安装Piwigo</a></li></ul>
                    </li>
                    <li>
                        <a href="#5%e5%ae%89%e8%a3%85%e6%88%90%e5%8a%9f%e5%90%8e%e7%9a%84%e4%b8%80%e4%ba%9b%e8%ae%be%e7%bd%ae" aria-label="5、安装成功后的一些设置">5、安装成功后的一些设置</a></li>
                    <li>
                        <a href="#6%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0" aria-label="6、参考文章:">6、参考文章:</a>
                    </li>
                </ul>
                </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>
  <div class="post-content"><h1 id="基于树莓派-piwigoapache2-的家庭云相册搭建">基于树莓派-piwigo/apache2 的家庭云相册搭建<a hidden class="anchor" aria-hidden="true" href="#基于树莓派-piwigoapache2-的家庭云相册搭建">#</a></h1>
<h2 id="背景">背景<a hidden class="anchor" aria-hidden="true" href="#背景">#</a></h2>
<p>近期由于拍摄了很多我和胡小蕊在一起的照片，包括生活照片和出去游玩的照片，所以想搞一个家庭云相册，可以用于实时同步手机中的照片到云相册上。因为考虑到公有云相册的隐私安全保障问题，以及我想自己DIY一些功能。还有就是自己的手机内存问题以及手机自带的云相册需要付费申请更大的空间，我不想付费。因此我想可以利用树莓派作为服务器，寻找一个开源的云相册管理系统自己部署到服务器上，最好是带有软件的开源云相册。找来找去发现了这款PiWigo云相册，详细请见：<a href = "https://piwigo.org/"> PIWIGO 官网</a>，这里是github地址: <a href = "https://github.com/Piwigo/Piwigo"> PIWIGO github仓库 </a></p>
<h3 id="1介绍">1、介绍<a hidden class="anchor" aria-hidden="true" href="#1介绍">#</a></h3>
<p>这篇博客介绍如何在树莓派4上安装PiWigo作为一个web server。 Piwigo是一个开源的相册管理软件，可以轻松的管理我们的照片和相册。我们可以在PC端或者安卓端以及iphone上进行浏览和同步。</p>
<h3 id="2要求">2、要求<a hidden class="anchor" aria-hidden="true" href="#2要求">#</a></h3>
<p>下面这些是必须需要提前准备好的：</p>
<li>树莓派4B 以及安装好Raspberry Pi OS 这个不在本教程之内</li>
<li>树莓派4B的终端，这个一般安装好树莓派OS就会有，但是最好打开SSH连接，远程操作，一般树莓派也就是当作一个服务器</li>
<h3 id="3配置树莓派4b作为一个web-服务器">3、配置树莓派4B作为一个WEB 服务器<a hidden class="anchor" aria-hidden="true" href="#3配置树莓派4b作为一个web-服务器">#</a></h3>
<h4 id="31-确认-raspberry-pi-4-os-是最新的">3.1 确认 Raspberry Pi 4 OS 是最新的<a hidden class="anchor" aria-hidden="true" href="#31-确认-raspberry-pi-4-os-是最新的">#</a></h4>
<p>在执行该命令之前，若是中国大陆用户需要将apt源更换，具体更换流程： <a href = "https://zhuanlan.zhihu.com/p/98079246">如何更换树莓派OS软件源</a></p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update -y &amp;&amp; sudo apt upgrade -y &amp;&amp; sudo apt autoremove -y
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="32-安装web服务--apache">3.2 安装WEB服务  (Apache)<a hidden class="anchor" aria-hidden="true" href="#32-安装web服务--apache">#</a></h4>
<p>我们知道web服务有很多选择，例如nginx apache,我们这里选择Apache</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install apache2 -y
</span></span></code></pre></td></tr></table>
</div>
</div><p>等待终端打印字符结束，可以打开本地树莓派ip地址，看到以下网页显示即安装成功
<img loading="lazy" src="https://s2.loli.net/2024/02/18/Ren2MkmVyZOFJjl.webp" alt="Apache2-start-page.webp"  />
</p>
<h4 id="33-安装php相关依赖">3.3 安装PHP相关依赖<a hidden class="anchor" aria-hidden="true" href="#33-安装php相关依赖">#</a></h4>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install php-imagick php-gd ffmpeg php-mbstring php-xml -y
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="34-安装数据库">3.4 安装数据库<a hidden class="anchor" aria-hidden="true" href="#34-安装数据库">#</a></h4>
<p>我们使用MariaDB 代替Mysql, MariaDB是Mysql的一个子分支，但是更小更轻便</p>
<p>1、输入以下代码安装mariadb</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install mariadb-server php-mysql -y
</span></span></code></pre></td></tr></table>
</div>
</div><p>2、等待安装完成之后，输入以下命令配置数据库相关信息及环境变量</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mysql_secure_installation
</span></span></code></pre></td></tr></table>
</div>
</div><p>执完命令之后，终端将会显示如下
<img loading="lazy" src="https://s2.loli.net/2024/02/18/7UHkAGTWpghe6jm.webp" alt="Raspberry-Pi-4-Securing-MariaDB-database-environment.webp"  />
</p>
<p>3、依次回答终端上显示的问题如下:</p>
<li>As no password has been set yet press enter.</li>
<li>Switch to unix_socket authentication [Y/n] –> n</li>
<li>Change the root password? [Y/n] –> Y</li>
<li>New password: –> type your new root password
Make sure you remember/store is for example with the Keepass password manager.</li>
<li>Re-enter new password: –> type again your new root password</li>
<li>Remove anonymous users? [Y/n] –> Y
Info displayed in Terminal window: By default, a MariaDB installation has an anonymous user, allowing anyone to log into MariaDB without having to have a user account created for them. This is intended only for testing, and to make the installation go a bit smoother. You should remove them before moving into a production environment.</li>
<li>Disallow root login remotely? [Y/n] –> Y
Info displayed in Terminal window: Normally, root should only be allowed to connect from ‘localhost’. This ensures that someone cannot guess at the root password from the network.</li>
<li>Remove test database and access to it? [Y/n] –> Y
Info displayed in Terminal window: By default, MariaDB comes with a database named ‘test’ that anyone can access. This is also intended only for testing, and should be removed before moving into a production environment.</li>
<li>Reload privilege tables now? [Y/n] –> Y
Info displayed in Terminal window: Reloading the privilege tables will ensure that all changes made so far will take effect immediately.</li>
<p>4、为了更好的管理我们的数据库我们安装一个phpMyAdmin</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install phpmyadmin -y
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://s2.loli.net/2024/02/18/trlqdsYyDmPFLoB.webp" alt="Pasted-2.webp"  />
</p>
<p>5、在终端显示的设置中，我们进行以下设置：
a、使用空格键选择apache2（选择到后会显示一个*号），然后我们使用TAB键选择OK，ENTER,继续下一步:
b、选择yes  to configure the database for phpmyadmin with dbconfig-common.</p>
<p><img loading="lazy" src="https://s2.loli.net/2024/02/18/NwrZlXcoyY7M19s.webp" alt="Pasted-3.webp"  />
</p>
<p>c、下一个终端显示的配置中，配置我们数据库用户phpmyadmin的密码
<img loading="lazy" src="https://s2.loli.net/2024/02/18/yUMjewYOJdFAW3X.webp" alt="Pasted-4.webp"  />
</p>
<p>6、给予 phpMyAdmin 用户权限
a、使用root用户登录 MariaDB</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mysql -uroot -p
</span></span></code></pre></td></tr></table>
</div>
</div><p>给予权限</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grant all privileges on *.* to <span style="color:#0ff;font-weight:bold">&#39;phpmyadmin&#39;</span>@<span style="color:#0ff;font-weight:bold">&#39;localhost&#39;</span>;
</span></span><span style="display:flex;"><span>flush privileges;
</span></span><span style="display:flex;"><span>quit
</span></span></code></pre></td></tr></table>
</div>
</div><p>7、重启树莓派</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo reboot
</span></span></code></pre></td></tr></table>
</div>
</div><p>8、打开树莓派对应局域网ip:for example http://192.168.2.148/phpmyadmin,    可以见到以下页面
<img loading="lazy" src="https://s2.loli.net/2024/02/18/AsKSXEhjVfMpNCd.png" alt="Pasted-5.png"  />
</p>
<p>9、使用 phpmyadmin作为用户名，密码为刚刚设置的密码进行登录</p>
<h3 id="4安装piwigo">4、安装Piwigo<a hidden class="anchor" aria-hidden="true" href="#4安装piwigo">#</a></h3>
<p>在安装PiWiGo之前，数据库需要初始化，新建库表等操作</p>
<h4 id="41-设置数据库">4.1 设置数据库<a hidden class="anchor" aria-hidden="true" href="#41-设置数据库">#</a></h4>
<p>1、以root用户名登录数据库</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mariadb -u root
</span></span></code></pre></td></tr></table>
</div>
</div><p>2、创建数据库 piwigo_13_dev, 你可以用你喜欢的名称</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>create database piwigo_13_dev;
</span></span></code></pre></td></tr></table>
</div>
</div><p>3、将 Piwigo 数据库的所有权限授予您将在后续步骤中在 Piwigo 中配置的用户（带密码）</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>grant all privileges on piwigo_13_dev.* to piwigo_13_dev_user@localhost identified by <span style="color:#0ff;font-weight:bold">&#39;********&#39;</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><p>4、刷新权限表以使更改生效，然后退出</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>flush privileges;
</span></span><span style="display:flex;"><span>exit;
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="42-安装piwigo">4.2 安装Piwigo<a hidden class="anchor" aria-hidden="true" href="#42-安装piwigo">#</a></h4>
<p>我们使用手动方法来安装Piwigo。</p>
<p>1、直接在树莓派中下载安装包并解压</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl http://piwigo.org/download/dlcounter.php?code=latest -o piwigo.zip
</span></span><span style="display:flex;"><span>unzip piwigo.zip
</span></span></code></pre></td></tr></table>
</div>
</div><p>2、现在必须将包含解压缩的 Piwigo 文件的文件夹的内容移至 Apache 公共文件夹中。将“PIWIGO”文件夹替换为您喜欢的名称（小写），记住在 URL 和以下命令中都使用您的文件夹名称：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mkdir /var/www/html/PIWIGO
</span></span><span style="display:flex;"><span>sudo mv piwigo/{.,}* /var/www/html/PIWIGO/
</span></span></code></pre></td></tr></table>
</div>
</div><p>就我而言，我使用了</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mkdir /var/www/html/piwigo13dev
</span></span><span style="display:flex;"><span>sudo mv piwigo/{.,}* /var/www/html/piwigo13dev/
</span></span></code></pre></td></tr></table>
</div>
</div><p>move命令mv会给出警告，；设备或资源繁忙，无法移动&hellip;等, 可以忽略，我们可以直接到目标文件夹中查看，发现已经全部移动过去了</p>
<p>3、为公共文件夹分配正确的权限，以便 Piwigo 安装程序能够执行其任务：</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chown -R www-data:www-data /var/www/html/
</span></span></code></pre></td></tr></table>
</div>
</div><p>4、删除用于解压 piwigo 文件的文件夹</p>
<div class="highlight"><div style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#727272">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rmdir piwigo/
</span></span></code></pre></td></tr></table>
</div>
</div><p>5、我们现在使用浏览器来完成安装步骤。输入您的 Raspberry PI 的 IP 地址作为 URL，后跟步骤 2 中使用的“piwigo”文件夹名称。所以在我的例子中，它变成 http://192.168.2.148/piwigo13dev 将显示 Piwigo 安装页面。
<img loading="lazy" src="https://s2.loli.net/2024/02/18/MK1e4wjgAyJqkuH.webp" alt="Pasted-7.webp"  />
</p>
<p>6、添加您的数据库名称、数据库用户和数据库用户密码。将主机变量设置为“localhost”。</p>
<p>7、选择 piwigo 管理员用户名、密码和电子邮件地址。这些将是您用来访问网络仪表板的。就我而言，我输入了以下内容：</p>
<p><img loading="lazy" src="https://s2.loli.net/2024/02/18/jrK7suNV3UI8ybd.webp" alt="Pasted-8.webp"  />

8、单击“开始安装”。</p>
<h3 id="5安装成功后的一些设置">5、安装成功后的一些设置<a hidden class="anchor" aria-hidden="true" href="#5安装成功后的一些设置">#</a></h3>
<p><img loading="lazy" src="https://s2.loli.net/2024/02/18/japcx7V81mRuOX6.png" alt="微信图片_20240218230050.png"  />
</p>
<p>通过照片管理可以进行添加照片等操作，相册管理可以进行相册的增加与删除修改。可以下载相应的APP与该服务端进行交互，设置同步相册可以进行定时同步操作.</p>
<p>在实际使用中我也遇到了一些问题，比如在ios端设置自动同步相册的时候，不能选择多久同步一次，但是在安卓端就有这个功能，然后在IOS端和安卓端都不能设置多个相册同步，只能选择单个相册同步，在这个项目的issue里好像也没有看到有人吐槽过这个问题，不过这些问题都不属于bug，吐槽了作者估计也不会搭理，后续看看有时间自己fork过来改进一下&hellip;</p>
<p><img loading="lazy" src="https://s2.loli.net/2024/02/21/YVzErXZlUePyTNf.jpg" alt="微信图片_20240221224942.jpg"  />
</p>
<p><img loading="lazy" src="https://s2.loli.net/2024/02/21/x6d4SyIefpO7aCr.png" alt="微信图片_20240221224933.png"  />
</p>
<p>自动上传这块可设置的东西太少了！
<img loading="lazy" src="https://s2.loli.net/2024/02/21/hAQY2EbkGqjT6Fx.png" alt="微信图片_20240221224939.png"  />
</p>
<h3 id="6参考文章">6、参考文章:<a hidden class="anchor" aria-hidden="true" href="#6参考文章">#</a></h3>
<p>1、<a href = "https://www.fotokruse.eu/how-to-install-piwigo-on-a-raspberry-pi-4/"> How to install Piwigo on a Raspberry Pi 4? </a> <br>
2、<a href = "https://www.makeuseof.com/install-use-piwigo-raspberry-pi/"> How to Install and Use Piwigo on Your Raspberry Pi </a><br>
3、<a href = "https://peppe8o.com/piwigo-and-raspberry-pi-a-private-open-source-photo-management-platform/">Piwigo and Raspberry PI: a Private Open Source Photo Management Platform</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://csqread.top/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/">树莓派</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://csqread.top/posts/tech/ddia%E7%AC%AC%E5%8D%81%E7%AB%A0/">
    <span class="title">« 上一页</span>
    <br>
    <span>DDIA第十章</span>
  </a>
  <a class="next" href="https://csqread.top/posts/tech/ddia%E7%AC%AC%E4%B9%9D%E7%AB%A0/">
    <span class="title">下一页 »</span>
    <br>
    <span>DDIA第九章</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://csqread.top">Qian&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
